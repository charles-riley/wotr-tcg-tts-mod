-- scoreboard
scoreboard_text = "0272bc"

-- scoring areas
free_peoples_scoring_area = "ed3b24"
shadow_scoring_area = "e68cea"

-- decks
promo = getObjectFromGUID("ca1c89")
southron = getObjectFromGUID("de4160")
mordor = getObjectFromGUID("d65d92")
monstrous = getObjectFromGUID("09fdaf")
isengard = getObjectFromGUID("35d66b")
dunedain = getObjectFromGUID("97410e")
dwarf = getObjectFromGUID("fd4a10")
elf = getObjectFromGUID("fdd6df")
hobbit = getObjectFromGUID("f80dcd")
rohan = getObjectFromGUID("b3b90d")
wizard = getObjectFromGUID("07521f")
shadow_battlegrounds = getObjectFromGUID("a5c0cc")
free_peoples_battlegrounds = getObjectFromGUID("4901f5")
path1 = getObjectFromGUID("67ee66")
path2 = getObjectFromGUID("516e6d")
path3 = getObjectFromGUID("0e2dd5")
path4 = getObjectFromGUID("e57422")
path5 = getObjectFromGUID("8b9c9b")
path6 = getObjectFromGUID("0f0ae8")
path7 = getObjectFromGUID("20d269")
path8 = getObjectFromGUID("43323d")
path9 = getObjectFromGUID("587f9e")

-- cards
shadow_helper = getObjectFromGUID("23c333")
free_peoples_helper = getObjectFromGUID("05f876")
turn_tracker = getObjectFromGUID("56494f")
turn_tracker_token = getObjectFromGUID("7e74fe")
first_player_token = getObjectFromGUID("fbb784")
-- paths
-- 9
orodruin_card_guid = "54df4a"
crack_of_doom_card_guid = "25d931"
morgai_card_guid = "d53b7e"
-- 8
shelobs_lair_card_guid = "70c8d0"
cirith_ungol_card_guid = "36908a"
morgul_vale_card_guid = "9aca51"
-- 7
henneth_annun_card_guid = "90d4b6"
osgiliath_card_guid = "a1df35"
the_cross_roads_card_guid = "b5eb08"
-- 6
amon_hen_card_guid = "669e8b"
dead_marshes_card_guid = "e9ff3d"
emyn_muil_card_guid = "a0b661"
-- 5
egladil_card_guid = "7f42f3"
dimrill_dale_card_guid = "52a02d"
lothlorien_card_guid = "fcc50f"
-- 4
the_doors_of_durin_card_guid = "f5c40e"
khazad_dum_card_guid = "1555db"
caradhras_card_guid = "795b55"
-- 3
council_of_elrond_card_guid = "e02d69"
fords_of_bruinen_card_guid = "4dc5f1"
imladris_card_guid = "10b425"
-- 2
weathertop_card_guid = "2adbc5"
the_old_forest_card_guid = "dfb10d"
inn_of_the_prancing_pony_card_guid = "4e1eca"
-- 1
bag_end_card_guid = "bd3611"
bucklebury_ferry_card_guid = "cfd488"
gildors_encampent_card_guid = "10d61e"
-- battlegrounds
free_peoples_battlegrounds_deck = getObjectFromGUID("4901f5")
edoras_card_guid = "ad8dac"
lorien_card_guid = "9f9228"
rivendell_card_guid = "b9d04e"
helms_deep_card_guid = "ede38d"
dol_amroth_card_guid = "96ca87"
minas_tirith_card_guid = "ebb9ac"
pelagir_card_guid = "ca9c0a"
shadow_battlegrounds_deck = getObjectFromGUID("a5c0cc")
moria_card_guid = "d8e084"
dol_guldur_card_guid = "4e536e"
minas_morgul_card_guid = "8fbfd0"
orthanc_card_guid = "8a4b2e"
morannon_card_guid = "6517fe"
harad_card_guid = "3075a5"
umbar_card_guid = "496a36"
-- dunedain
blade_of_westernesse_card_guid = "0ce7a3"
boromir_card_guid = "d53878"
strider_card_guid =  "9d2ed6"
-- hobbit
bilbo_card_guid = "7d9ade"
sting_card_guid = "c79b25"
there_is_another_way_card_guid = "25336e"
mithril_coat_card_guid = "9cf4d5"
herbs_and_stewed_rabbit_card_guid = "79dfe6"
sam_gamgee_card_guid = "6abc42"
bilbo_baggins_card_guid = "7d9ade"
fatty_bolger_card_guid = "c1189b"
merry_brandybuck_card_guid = "6e3c7d"
frodo_baggins_card_guid = "ebabb4"
pippin_took_card_guid = "613ff3"
-- wizard
gandalf_the_gray_card_guid = "f96e97"
narya_card_guid = "8b35f8"
gandalfs_staff_card_guid = "11b782"
glamdring_card_guid = "b6b21f"
treebeard_card_guid = "64a479"
quickbeam_card_guid = "8ccf08"
gwaihir_card_guid = "f18828"
ent_draught_card_guid = "0f0e9e"
gandalf_the_white_card_guid = "ff002b"
smeagol_card_guid = "cb0f18"
-- monstrous
flocks_of_crebain_card_guid = "0e0b9d"
gollum_card_guid = "2a38e3"
hill_troll_card_guid = "ba9c77"
candles_of_corpses_card_guid = "9e1141"
shelob_card_guid = "7f2fee"
balrog_of_moria_guid = "ba64b8"
goblins_of_the_misty_mountain_1_card_guid = "86afd9"
goblins_of_the_misty_mountain_2_card_guid = "dca8fc"
cave_troll_card_guid = "e39344"
barrow_wights_card_guid = "e7eadb"
caradhras_the_cruel_card_guid = "0fb191"
-- isengard
saruman_card_guid = "922758"
palantir_of_orthanc_card_guid = "4d678e"
ugluk_card_guid = "ceb05c"
sarumans_staff_card_guid = "5f38e3"
-- mordor
the_hunter_card_guid = "822122"
the_messenger_card_guid = "d98002"
the_black_captain_card_guid = "688cc9"
the_beguiler_card_guid = "6d35a8"
the_destroyer_card_guid = "b12e43"
the_warrior_card_guid = "af6e59"
the_reaver_card_guid = "2da396"
the_witch_king_card_guid = "0ff6d4"
the_commander_card_guid = "55f802"
the_lidless_eye_card_guid = "3c6566"
morgul_blade_card_guid = "de89b2"
mordor_orcs_1_card_guid = "47d045"
mordor_orcs_2_card_guid = "3978ac"
mordor_orcs_3_card_guid = "5a95dc"
mordor_orcs_4_card_guid = "0cf0dd"
mordor_orcs_5_card_guid = "df6d1e"
black_uruks_card_guid = "f3c38a"
the_ringwraiths_are_abroad_card_guid = "520f24"
the_day_without_dawn_card_guid = "1f17eb"
mouth_of_sauron_card_guid = "4dcabf"
trolls_of_udun_guid = "8d24a4"
the_black_esterling_card_guid = "fa96d8"
grond_card_guid = "49e63c"
black_breath_card_guid = "232383"
olog_hai_card_guid = "540933"
nazguls_mantle_card_guid = "9036e7"
gorbag_and_shagrat_card_guid = "47e86d"
black_riders_mount_card_guid = "096f7e"
fell_beast_card_guid = "201221"
grishnakh_card_guid = "14fdfc"
-- promo
ioreth_card_guid = "2326d4"
ghan_card_guid = "8e049f"
whip_card_guid = "ef5909"
gothmog_card_guid = "987c37"

-- rings
witch_king_ring = getObjectFromGUID("3ea385")
saruman_ring = getObjectFromGUID("b47492")
aragorn_ring = getObjectFromGUID("b5aa21")
frodo_ring = getObjectFromGUID("076e4f")

-- other
trash = getObjectFromGUID("c01b96")

-- positions
yellow_exiled = {-30.00, 0.97, -32.00}
yellow_draw = {-24.00, 0.97, -32.00}
yellow_cycled = {-18.00, 0.97, -32.00}
brown_exiled = {18.00, 0.97, -32.00}
brown_draw = {24.00, 0.97, -32.00}
brown_cycled = {30.00, 0.97, -32.00}
blue_exiled = {30.00, 0.97, 32.00}
blue_draw = {24.00, 0.97, 32.00}
blue_cycled = {18.00, 0.97, 32.00}
teal_exiled = {-18.00, 0.97, 32.00}
teal_draw = {-24.00, 0.97, 32.00}
teal_cycled = {-30.00, 1.02, 32.00}
--shadow_helper_pos = Vector(0, 0.974822, -32)
shadow_helper_pos = Vector(0, 3.76, -32)
free_peoples_helper_pos = Vector(0, 0.974822, 31.999998)
path_pos = Vector(50, 0.99659, 0)
witch_king_ring_pos = {14.00, 0.96, -22.00}
saruman_ring_pos = {-14.00, 0.96, -22.00}
frodo_ring_pos = {-14.00, 0.96, 22.00}
aragorn_ring_pos = {12.00, 0.96, 22.00}
turn_tracker_token_pos = Vector(-52, 10, 2)
fellowship_battlegrounds_pos = Vector(50, 1.14, 4)
fellowship_path_pos = Vector(50, 1.14, -4)

-- rotations
turn_tracker_rot = Vector(0, 90, 180)

function setScenario(player, option, id) 
    scenario = option
end

function setIncludeGothmog(player, option, id)
    include_gothmog = option
end

function setIncludeWhip(player, option, id)
    include_whip = option
end

function setIncludeGhan(player, option, id)
    include_ghan = option
end

function setIncludeIoreth(player, option, id)
    include_ioreth = option
end

function setUpGame()
    if scenario == nil then scenario = "Trilogy" end

    if include_gothmog == nil then include_gothmog = self.UI.getAttribute("include_gothmog", "isOn") end
    if include_whip == nil then include_whip = self.UI.getAttribute("include_whip", "isOn") end
    if include_ghan == nil then include_ghan = self.UI.getAttribute("include_ghan", "isOn") end
    if include_ioreth == nil then include_ioreth = self.UI.getAttribute("include_ioreth", "isOn") end

    if scenario == "Trilogy" then set_up_trilogy() end

    if scenario == "2 Player Duel" then set_up_2_player_duel() end

    if scenario == "3 Player Duel" then set_up_3_player_duel() end

    if scenario == "Fellowship" then set_up_fellowship() end
    
    -- destroyObject(self)
    self.setPosition({0.00, -5.00, 0.00})
    self.setRotation({0.00, 0.00, 180.00})
end

function set_up_trilogy()
    

    -- witch king
    mordor.setPosition(brown_draw)
    mordor.setRotation(Vector(0,180,180)) 
    if include_gothmog == "true" then mordor.putObject(getObjectFromGUID(gothmog_card_guid)) else trash.putObject(getObjectFromGUID(gothmog_card_guid)) end   
    mordor.randomize()
    mordor.deal(7, "Brown")
    witch_king_ring.setPosition(witch_king_ring_pos)

    -- saruman
    isengard.setPosition(yellow_draw)
    isengard.setRotation(Vector(0,180,180))
    for i = 1, 7 do
        isengard.putObject(southron.takeObject())
    end
    for i = 1, 11 do
        isengard.putObject(monstrous.takeObject())
    end
    if include_whip == "true" then isengard.putObject(getObjectFromGUID(whip_card_guid)) else trash.putObject(getObjectFromGUID(whip_card_guid)) end
    isengard.randomize()
    isengard.deal(7, "Yellow")
    saruman_ring.setPosition(saruman_ring_pos)


    -- shadow helper
    shadow_helper.setPosition(shadow_helper_pos)
    shadow_helper.setRotation(Vector(0,90,0))

    -- shadow battlegrounds
    shadow_battlegrounds.randomize()

    -- frodo
    hobbit.setPosition(teal_draw)
    hobbit.setRotation(Vector(0,0,180))
    for i = 1, 2 do
        hobbit.putObject(dwarf.takeObject())
    end 
    for i = 1, 8 do
        hobbit.putObject(rohan.takeObject())
    end
    for i = 1, 10 do
        hobbit.putObject(wizard.takeObject())
    end
    if include_ghan == "true" then hobbit.putObject(getObjectFromGUID(ghan_card_guid)) else trash.putObject(getObjectFromGUID(ghan_card_guid)) end   
    hobbit.randomize()
    hobbit.deal(7, "Teal")
    frodo_ring.setPosition(frodo_ring_pos)

    -- aragorn
    dunedain.setPosition(blue_draw)
    dunedain.setRotation(Vector(0,0,180))
    elf.setPosition(blue_draw)
    elf.setRotation(Vector(0,0,180))
    for i = 1, 9 do
        dunedain.putObject(elf.takeObject())
    end
    if include_ioreth == "true" then dunedain.putObject(getObjectFromGUID(ioreth_card_guid)) else trash.putObject(getObjectFromGUID(ioreth_card_guid)) end   
    dunedain.randomize()
    dunedain.deal(7, "Green")
    aragorn_ring.setPosition(aragorn_ring_pos)

    -- free peoples helper
    free_peoples_helper.setPosition(free_peoples_helper_pos)
    free_peoples_helper.setRotation(Vector(0,-90,0))    

    -- free peoples battlegrounds
    free_peoples_battlegrounds.randomize()

    -- paths
    path9.randomize()
    path9.setPosition(Vector(-50, 1 ,0))
    path9.setPosition(path_pos)
    path8.randomize()
    path8.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do
        path8.takeObject({ position = path_pos + Vector(0, 1, 0), smooth = true })
    end
    path7.randomize()
    path7.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do 
        path7.takeObject({ position = path_pos + Vector(0, 2, 0), smooth = true })
    end
    path6.randomize()
    path6.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do 
        path6.takeObject({ position = path_pos + Vector(0, 3, 0), smooth = true })
    end
    path5.randomize()
    path5.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do 
        path5.takeObject({ position = path_pos + Vector(0, 4, 0), smooth = true })
    end
    path4.randomize()
    path4.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do 
        path4.takeObject({ position = path_pos + Vector(0, 5, 0), smooth = true })
    end
    path3.randomize()
    path3.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do 
        path3.takeObject({ position = path_pos + Vector(0, 6, 0), smooth = true })
    end
    path2.randomize()
    path2.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do 
        path2.takeObject({ position = path_pos + Vector(0, 7, 0), smooth = true })
    end
    path1.randomize()
    path1.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do 
        path1.takeObject({ position = path_pos + Vector(0, 8, 0), smooth = true })
    end
 
end

function set_up_2_player_duel()
    -- witch king
    mordor.setPosition(brown_draw)
    mordor.setRotation(Vector(0,180,180))
    for i = 1, 7 do
        mordor.putObject(southron.takeObject())
    end
    for i = 1, 11 do
        mordor.putObject(monstrous.takeObject())
    end
    for i =1, 12 do
        mordor.putObject(isengard.takeObject())
    end
    if include_gothmog == "true" then mordor.putObject(getObjectFromGUID(gothmog_card_guid)) else trash.putObject(getObjectFromGUID(gothmog_card_guid)) end   
    if include_whip == "true" then mordor.putObject(getObjectFromGUID(whip_card_guid)) else trash.putObject(getObjectFromGUID(whip_card_guid)) end   
    mordor.randomize()
    mordor.deal(6, "Brown")
    witch_king_ring.setPosition(witch_king_ring_pos)
    trash.putObject(saruman_ring)

    -- shadow helper
    shadow_helper.setPosition(shadow_helper_pos)
    shadow_helper.setRotation(Vector(0,90,180))

    -- shadow battlegrounds
    shadow_battlegrounds.randomize()

    -- gandalf
    wizard.setPosition(blue_draw)
    wizard.setRotation(Vector(0,0,180))
    for i = 1, 13 do
        wizard.putObject(elf.takeObject())
    end
    for i = 1, 2 do
        wizard.putObject(dwarf.takeObject())
    end 
    for i = 1, 8 do
        wizard.putObject(rohan.takeObject())
    end
    for i = 1, 21 do
        wizard.putObject(dunedain.takeObject())
    end
    for i = 1, 10 do
        wizard.putObject(hobbit.takeObject())
    end
    if include_ghan == "true" then wizard.putObject(getObjectFromGUID(ghan_card_guid)) else trash.putObject(getObjectFromGUID(ghan_card_guid)) end   
    if include_ioreth == "true" then wizard.putObject(getObjectFromGUID(ioreth_card_guid)) else trash.putObject(getObjectFromGUID(ioreth_card_guid)) end   
    wizard.randomize()
    wizard.deal(4, "Green")
    aragorn_ring.setPosition(aragorn_ring_pos)
    trash.putObject(frodo_ring) 

    -- free peoples helper
    free_peoples_helper.setPosition(free_peoples_helper_pos)
    free_peoples_helper.setRotation(Vector(0,270,180))    

    -- free peoples battlegrounds
    free_peoples_battlegrounds.randomize()

    -- paths
    path9.randomize()
    path9.setPosition(Vector(-50, 1 ,0))
    path9.setPosition(path_pos)
    path8.randomize()
    path8.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do
        path8.takeObject({ position = path_pos + Vector(0, 1, 0), smooth = true })
    end
    path7.randomize()
    path7.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do 
        path7.takeObject({ position = path_pos + Vector(0, 2, 0), smooth = true })
    end
    path6.randomize()
    path6.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do 
        path6.takeObject({ position = path_pos + Vector(0, 3, 0), smooth = true })
    end
    path5.randomize()
    path5.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do 
        path5.takeObject({ position = path_pos + Vector(0, 4, 0), smooth = true })
    end
    path4.randomize()
    path4.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do 
        path4.takeObject({ position = path_pos + Vector(0, 5, 0), smooth = true })
    end
    path3.randomize()
    path3.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do 
        path3.takeObject({ position = path_pos + Vector(0, 6, 0), smooth = true })
    end
    path2.randomize()
    path2.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do 
        path2.takeObject({ position = path_pos + Vector(0, 7, 0), smooth = true })
    end
    path1.randomize()
    path1.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do 
        path1.takeObject({ position = path_pos + Vector(0, 8, 0), smooth = true })
    end

    -- turn tracker
    turn_tracker_token.setPosition(turn_tracker_token_pos)
    turn_tracker.setRotation(turn_tracker_rot)
end

function set_up_3_player_duel()

    -- witch king
    mordor.setPosition(brown_draw)
    mordor.setRotation(Vector(0,180,180)) 
    if include_gothmog == "true" then mordor.putObject(getObjectFromGUID(gothmog_card_guid))  else trash.putObject(getObjectFromGUID(gothmog_card_guid)) end   
    mordor.randomize()
    mordor.deal(7, "Brown")
    witch_king_ring.setPosition(witch_king_ring_pos)

    -- saruman
    isengard.setPosition(yellow_draw)
    isengard.setRotation(Vector(0,180,180))
    for i = 1, 7 do
        isengard.putObject(southron.takeObject())
    end
    for i = 1, 11 do
        isengard.putObject(monstrous.takeObject())
    end
    if include_whip == "true" then isengard.putObject(getObjectFromGUID(whip_card_guid))  else trash.putObject(getObjectFromGUID(whip_card_guid))  end   
    isengard.randomize()
    isengard.deal(7, "Yellow")
    saruman_ring.setPosition(saruman_ring_pos)

    -- shadow helper
    shadow_helper.setPosition(shadow_helper_pos)
    shadow_helper.setRotation(Vector(0,90,180))

    -- shadow battlegrounds
    shadow_battlegrounds.randomize()

    -- gandalf
    wizard.setPosition(blue_draw)
    wizard.setRotation(Vector(0,0,180))
    for i = 1, 13 do
        wizard.putObject(elf.takeObject())
    end
    for i = 1, 2 do
        wizard.putObject(dwarf.takeObject())
    end 
    for i = 1, 8 do
        wizard.putObject(rohan.takeObject())
    end
    for i = 1, 21 do
        wizard.putObject(dunedain.takeObject())
    end
    for i = 1, 10 do
        wizard.putObject(hobbit.takeObject())
    end
    if include_ghan == "true" then wizard.putObject(getObjectFromGUID(ghan_card_guid))  else trash.putObject(getObjectFromGUID(ghan_card_guid)) end   
    if include_ioreth == "true" then wizard.putObject(getObjectFromGUID(ioreth_card_guid))  else trash.putObject(getObjectFromGUID(ioreth_card_guid)) end   
    wizard.randomize()
    wizard.deal(6, "Green")
    aragorn_ring.setPosition(aragorn_ring_pos)
    trash.putObject(frodo_ring) 

    -- free peoples helper
    free_peoples_helper.setPosition(free_peoples_helper_pos)
    free_peoples_helper.setRotation(Vector(0,270,180))    

    -- free peoples battlegrounds
    free_peoples_battlegrounds.randomize()

    -- paths
    path9.randomize()
    path9.setPosition(Vector(-50, 1 ,0))
    path9.setPosition(path_pos)
    path8.randomize()
    path8.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do
        path8.takeObject({ position = path_pos + Vector(0, 1, 0), smooth = true })
    end
    path7.randomize()
    path7.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do 
        path7.takeObject({ position = path_pos + Vector(0, 2, 0), smooth = true })
    end
    path6.randomize()
    path6.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do 
        path6.takeObject({ position = path_pos + Vector(0, 3, 0), smooth = true })
    end
    path5.randomize()
    path5.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do 
        path5.takeObject({ position = path_pos + Vector(0, 4, 0), smooth = true })
    end
    path4.randomize()
    path4.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do 
        path4.takeObject({ position = path_pos + Vector(0, 5, 0), smooth = true })
    end
    path3.randomize()
    path3.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do 
        path3.takeObject({ position = path_pos + Vector(0, 6, 0), smooth = true })
    end
    path2.randomize()
    path2.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do 
        path2.takeObject({ position = path_pos + Vector(0, 7, 0), smooth = true })
    end
    path1.randomize()
    path1.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do 
        path1.takeObject({ position = path_pos + Vector(0, 8, 0), smooth = true })
    end

    -- turn tracker
    turn_tracker_token.setPosition(turn_tracker_token_pos)
    turn_tracker.setRotation(turn_tracker_rot)
end

function set_up_fellowship()
    -- turn tracker
    turn_tracker.setRotation(turn_tracker_rot)
    turn_tracker_token.setPosition(Vector(-48, 1.06, 2.00))
    first_player_token.setPosition(Vector(-46, 1.24, 6))
    first_player_token.setRotation(Vector(0, 180, 180))
    
    -- balrog deck
    local shelob = monstrous.takeObject({ guid = shelob_card_guid})
    local coc = monstrous.takeObject({ guid = candles_of_corpses_card_guid })
    local gollum = monstrous.takeObject({ guid = gollum_card_guid})
    trash.putObject(shelob)
    trash.putObject(coc)
    trash.putObject(gollum)
    monstrous.setPosition(brown_draw)
    monstrous.setRotation(Vector(0,180,180))
    if include_gothmog == "true" then monstrous.putObject(getObjectFromGUID(gothmog_card_guid)) else trash.putObject(getObjectFromGUID(gothmog_card_guid)) end   
    if include_whip == "true" then monstrous.putObject(getObjectFromGUID(whip_card_guid)) else trash.putObject(getObjectFromGUID(whip_card_guid)) end   
    local black_breath_card = mordor.takeObject({ guid = black_breath_card_guid })
    monstrous.putObject(black_breath_card)
    local black_riders_mount_card = mordor.takeObject({ guid = black_riders_mount_card_guid})
    monstrous.putObject(black_riders_mount_card)
    local grishnakh_card = mordor.takeObject({ guid = grishnakh_card_guid})
    monstrous.putObject(grishnakh_card)
    local mordor_orcs_1_card = mordor.takeObject({ guid = mordor_orcs_1_card_guid })
    monstrous.putObject(mordor_orcs_1_card)
    local mordor_orcs_2_card = mordor.takeObject({ guid = mordor_orcs_2_card_guid})
    monstrous.putObject(mordor_orcs_2_card)
    local mordor_orcs_3_card = mordor.takeObject({ guid = mordor_orcs_3_card_guid})
    monstrous.putObject(mordor_orcs_3_card)
    local morgul_blade_card = mordor.takeObject({ guid = morgul_blade_card_guid})
    monstrous.putObject(morgul_blade_card)
    local nazguls_mantle_card = mordor.takeObject({ guid = nazguls_mantle_card_guid})
    monstrous.putObject(nazguls_mantle_card)
    local the_ringwraiths_are_abroad_card = mordor.takeObject({ guid = the_ringwraiths_are_abroad_card_guid })
    monstrous.putObject(the_ringwraiths_are_abroad_card)
    local the_beguiler_card = mordor.takeObject({ guid = the_beguiler_card_guid })
    monstrous.putObject(the_beguiler_card)
    local the_destroyer_card = mordor.takeObject({ guid = the_destroyer_card_guid})
    monstrous.putObject(the_destroyer_card)
    local the_warrior_card = mordor.takeObject({ guid = the_warrior_card_guid})
    monstrous.putObject(the_warrior_card)
    local the_reaver_card = mordor.takeObject({ guid = the_reaver_card_guid})
    monstrous.putObject(the_reaver_card)
    local the_hunter_card = mordor.takeObject({ guid = the_hunter_card_guid })
    monstrous.putObject(the_hunter_card)
    local the_messenger_card = mordor.takeObject({ guid = the_messenger_card_guid })
    monstrous.putObject(the_messenger_card)
    local the_black_esterling_card = mordor.takeObject({ guid = the_black_esterling_card_guid })
    monstrous.putObject(the_black_esterling_card)
    local the_commander_card = mordor.takeObject({ guid = the_commander_card_guid })
    monstrous.putObject(the_commander_card)
    local the_witch_king_card = mordor.takeObject({ guid = the_witch_king_card_guid })
    monstrous.putObject(the_witch_king_card)
    trash.putObject(mordor)
    trash.putObject(southron)
    local palantir_card = isengard.takeObject({ guid = palantir_of_orthanc_card_guid})
    monstrous.putObject(palantir_card)
    local saruman_card = isengard.takeObject({ guid = saruman_card_guid })
    monstrous.putObject(saruman_card)
    local sarumans_staff_card = isengard.takeObject({ guid = sarumans_staff_card_guid})
    monstrous.putObject(sarumans_staff_card)
    local ugluk_card = isengard.takeObject({ guid = ugluk_card_guid})
    monstrous.putObject(ugluk_card)
    trash.putObject(isengard)
    monstrous.randomize()

    monstrous.deal(7, "Brown")

    trash.putObject(saruman_ring)
    trash.putObject(witch_king_ring)

    -- shadow helper
    shadow_helper.setPosition(shadow_helper_pos)
    shadow_helper.setRotation(Vector(0,90,180))

    -- shadow battlegrounds
    -- shadow_battlegrounds.randomize()

    -- gandalf
    local smeagol = wizard.takeObject({ guid = smeagol_card_guid})
    trash.putObject(smeagol)
    local gandalf_white = wizard.takeObject({ guid = gandalf_the_white_card_guid })
    trash.putObject(gandalf_white)
    local ent_draught_card = wizard.takeObject({ guid = ent_draught_card_guid })
    trash.putObject(ent_draught_card)
    local gwaihir_card = wizard.takeObject({ guid = gwaihir_card_guid})
    trash.putObject(gwaihir_card)
    local quickbeam_card = wizard.takeObject({ guid = quickbeam_card_guid })
    trash.putObject(quickbeam_card)
    local treebeard = wizard.takeObject({ guid = treebeard_card_guid})
    trash.putObject(treebeard)
    wizard.setPosition(blue_draw)
    wizard.setRotation(Vector(0,0,180))
    if include_ghan == "true" then wizard.putObject(getObjectFromGUID(ghan_card_guid)) else trash.putObject(getObjectFromGUID(ghan_card_guid)) end   
    if include_ioreth == "true" then wizard.putObject(getObjectFromGUID(ioreth_card_guid)) else trash.putObject(getObjectFromGUID(ioreth_card_guid)) end   
    local blade_card = dunedain.takeObject({ guid = blade_of_westernesse_card_guid})
    wizard.putObject(blade_card)
    local boromir = dunedain.takeObject({ guid = boromir_card_guid})
    wizard.putObject(boromir)
    local strider = dunedain.takeObject({ guid = strider_card_guid})
    wizard.putObject(strider)
    trash.putObject(dunedain)
    local dwarf1 = dwarf.takeObject()
    wizard.putObject(dwarf1)
    local dwarf2 = dwarf.takeObject()
    wizard.putObject(dwarf2)
    for i = 1, 13 do
        local elf_card = elf.takeObject()
        wizard.putObject(elf_card)
    end
    trash.putObject(hobbit.takeObject({guid = there_is_another_way_card_guid}))
    trash.putObject(hobbit.takeObject({guid = herbs_and_stewed_rabbit_card_guid}))
    for i = 1,8 do
        wizard.putObject(hobbit.takeObject())
    end 
    trash.putObject(rohan)

    wizard.randomize()

    wizard.deal(7, "Green")

    trash.putObject(frodo_ring)
    trash.putObject(aragorn_ring)

    -- free peoples helper
    free_peoples_helper.setPosition(free_peoples_helper_pos)
    free_peoples_helper.setRotation(Vector(0,270,180))    

    -- battlegrounds
    shadow_battlegrounds_deck.takeObject({ guid = morannon_card_guid, position = fellowship_battlegrounds_pos + Vector(0,1,0), smooth = true})
    shadow_battlegrounds_deck.takeObject({ guid = orthanc_card_guid, position = fellowship_battlegrounds_pos + Vector(0,2,0), smooth = true})
    shadow_battlegrounds_deck.takeObject({ guid = dol_guldur_card_guid, position = fellowship_battlegrounds_pos + Vector(0,3,0), smooth = true})
    free_peoples_battlegrounds_deck.takeObject({ guid = lorien_card_guid, position = fellowship_battlegrounds_pos + Vector(0,4,0), smooth = true})
    shadow_battlegrounds_deck.takeObject({ guid = moria_card_guid, position = fellowship_battlegrounds_pos + Vector(0,5,0), smooth = true})
    free_peoples_battlegrounds_deck.takeObject({ guid = rivendell_card_guid, position = fellowship_battlegrounds_pos + Vector(0,6,0), smooth = true})
    shadow_battlegrounds_deck.takeObject({ guid = minas_morgul_card_guid, position = fellowship_battlegrounds_pos + Vector(0,7,0), smooth = true})
    trash.putObject(shadow_battlegrounds_deck)
    trash.putObject(free_peoples_battlegrounds_deck)

    -- paths
    path6.takeObject({ guid = amon_hen_card_guid, position = fellowship_path_pos + Vector(0, 1, 0), smooth = true})
    path5.randomize()
    path5.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do
        path5.takeObject({position = fellowship_path_pos + Vector(0, 2, 0), smooth = true})
    end
    path4.randomize()
    path4.setPosition(Vector(-50, 1 ,0))
    for i = 1, 3 do
        path4.takeObject({position = fellowship_path_pos + Vector(0, 3, 0), smooth = true})
    end
    path3.setPosition(Vector(-50, 1 ,0))
    trash.putObject(path3.takeObject({ guid = council_of_elrond_card_guid}))
    path3.randomize()
    for i = 1, 2 do
        path3.takeObject({position = fellowship_path_pos + Vector(0, 4, 0), smooth = true})
    end
    path2.setPosition(Vector(-50, 1 ,0))
    trash.putObject(path2.takeObject({ guid = weathertop_card_guid}))
    path2.randomize()
    for i = 1, 2 do
        path2.takeObject({position = fellowship_path_pos + Vector(0, 5, 0), smooth = true})
    end
    path1.setPosition(Vector(-50, 1 ,0))
    trash.putObject(path1.takeObject({ guid = bag_end_card_guid}))
    path1.randomize()
    for i = 1, 2 do
        path1.takeObject({position = fellowship_path_pos + Vector(0, 6, 0), smooth = true})
    end
    trash.putObject(path9)
    trash.putObject(path8)
    trash.putObject(path7)
    trash.putObject(path6)
end

-- scoring areas
function onObjectEnterZone(zone, object)
    update_scores()
end

function onObjectLeaveZone(zone, object)
    update_scores()
end

function update_scores()
    
    local free_peoples_sum = 0
    for foo, occupyingObject in ipairs(getObjectFromGUID(free_peoples_scoring_area).getObjects(true)) do
        -- print(foo)
        -- print(occupyingObject.type)
        if occupyingObject.type == "Card" then
            -- occupyingObject.highlightOn('Red')
            -- print(occupyingObject.guid)
            free_peoples_sum = free_peoples_sum + battle_ground_points(occupyingObject.guid)
            free_peoples_sum = free_peoples_sum + path_points(occupyingObject.guid)
            -- print(free_peoples_sum)
        end

        if occupyingObject.type == "Deck" then
            for idx, obj in ipairs(occupyingObject.getObjects(true)) do
                free_peoples_sum = free_peoples_sum + battle_ground_points(obj.guid)
                free_peoples_sum = free_peoples_sum + path_points(obj.guid)
            end
        end

        -- rings
        if scenario == "Trilogy" then
            -- if occupyingObject.guid == "3ea385" then
            --     shadow_sum = shadow_sum +1
            -- end
            -- if occupyingObject.guid == "b47492" then
            --     shadow_sum = shadow_sum +1
            -- end
            if occupyingObject.guid == "b5aa21" then
                free_peoples_sum = free_peoples_sum +1
            end
            if occupyingObject.guid == "076e4f" then
                free_peoples_sum = free_peoples_sum +1
            end
        end
        -- print("Object " .. occupyingObject.guid .. " entered zone " .. zone.guid)
    end

    shadow_sum = 0
    for foo, occupyingObject in ipairs(getObjectFromGUID(shadow_scoring_area).getObjects(true)) do
        -- print(foo)
        -- print(occupyingObject.type)
        if occupyingObject.type == "Card" then
            -- occupyingObject.highlightOn('Red')
            -- print(occupyingObject.guid)
            shadow_sum = shadow_sum + battle_ground_points(occupyingObject.guid)
            -- shadow_sum = shadow_sum + path_points(occupyingObject.guid)
            -- print(shadow_sum)
        end

        if occupyingObject.type == "Deck" then
            for idx, obj in ipairs(occupyingObject.getObjects(true)) do
                shadow_sum = shadow_sum + battle_ground_points(obj.guid)
                -- shadow_sum = shadow_sum + path_points(occupyingObject.guid)
            end
        end

        if occupyingObject.hasTag("corruption") then
            shadow_sum = shadow_sum + 1
        end

        -- rings
        if scenario == "Trilogy" or scenario == "3 Player Duel" then
            if occupyingObject.guid == "3ea385" then
                shadow_sum = shadow_sum +1
            end
            if occupyingObject.guid == "b47492" then
                shadow_sum = shadow_sum +1
            end
            -- if occupyingObject.guid == "b5aa21" then
            --     shadow_sum = shadow_sum +1
            -- end
            -- if occupyingObject.guid == "076e4f" then
            --     shadow_sum = shadow_sum +1
            -- end
        end
    end

    local scoreboard = getObjectFromGUID(scoreboard_text)
    -- print(scoreboard.getValue())
    scoreboard.setValue("Score:\nShadow - " .. shadow_sum .. "\n" .. "Free Peoples - " .. free_peoples_sum)
end

function battle_ground_points(card_guid) 

    if card_guid == edoras_card_guid then return 1 end
    if card_guid == lorien_card_guid then return 2 end
    if card_guid == rivendell_card_guid then return 2 end
    if card_guid == helms_deep_card_guid then return 2 end
    if card_guid == dol_amroth_card_guid then return 1 end
    if card_guid == minas_tirith_card_guid then return 3 end
    if card_guid == pelagir_card_guid then return 1 end

    if card_guid == moria_card_guid then return 1 end
    if card_guid == dol_guldur_card_guid then return 1 end
    if card_guid == minas_morgul_card_guid then return 2 end
    if card_guid == orthanc_card_guid then return 2 end
    if card_guid == morannon_card_guid then return 2 end
    if card_guid == harad_card_guid then return 1 end
    if card_guid == umbar_card_guid then return 1 end
    return 0
end

function path_points(card_guid)
    -- 9
    if card_guid == orodruin_card_guid then return 3 end
    if card_guid == crack_of_doom_card_guid then return 3 end
    if card_guid == morgai_card_guid then return 3 end
    -- 8
    if card_guid == shelobs_lair_card_guid then return 2 end
    if card_guid == cirith_ungol_card_guid then return 2 end
    if card_guid == morgul_vale_card_guid then return 2 end
    -- 7
    if card_guid == henneth_annun_card_guid then return 1 end
    if card_guid == osgiliath_card_guid then return 1 end
    if card_guid == the_cross_roads_card_guid then return 1 end
    -- 6
    if card_guid == amon_hen_card_guid then return 2 end
    if card_guid == dead_marshes_card_guid then return 2 end
    if card_guid == emyn_muil_card_guid then return 2 end
    -- 5
    if card_guid == egladil_card_guid then return 1 end
    if card_guid == dimrill_dale_card_guid then return 1 end
    if card_guid == lothlorien_card_guid then return 1 end
    -- 4
    if card_guid == the_doors_of_durin_card_guid then return 2 end
    if card_guid == khazad_dum_card_guid then return 2 end
    if card_guid == caradhras_card_guid then return 2 end
    -- 3
    if card_guid == council_of_elrond_card_guid then return 1 end
    if card_guid == fords_of_bruinen_card_guid then return 1 end
    if card_guid == imladris_card_guid then return 1 end
    -- 2
    if card_guid == weathertop_card_guid then return 2 end
    if card_guid == the_old_forest_card_guid then return 2 end
    if card_guid == inn_of_the_prancing_pony_card_guid then return 2 end
    -- 1
    if card_guid == bag_end_card_guid then return 1 end
    if card_guid == bucklebury_ferry_card_guid then return 1 end
    if card_guid == gildors_encampent_card_guid then return 1 end

    return 0
end

function deleteSetup()
    destroyObject(self)
end
